/* low level triggering  mode */
/* falling Edge triggering  mode */


#include <lpc21xx.h>
#define led_1 1<<4 /*connect a led in p0.4 */
#define led_2 1<<5 /*connect a led in p0.5 */
#define led_3 1<<6 /*connect a led in p0.6 */
#define led_4 1<<7 /*connect a led in p0.7 */

#define IRQ_Slot_En 0x20 /*slot enable  bit in 5th bit of VICVectCntl register */ 

#define Eint0 14 /*External interrupt 0 in VIC block */
#define Eint1 15 /*External interrupt 1 in VIC block */
#define Eint2 16 /*External interrupt 2 in VIC block */
#define Eint3 17 /*External interrupt 3 in VIC block */


void config_intrpt(void);

void EXT_INT0_ISR(void)__irq /*ISR program  for EINT0*/
{
  EXTINT=0X01;// to clear EINT0 flag
	IOSET0=led_1;
	IOCLR0=led_1;
	VICVectAddr=0;// dumpy write to indicate end of ISR

}



void EXT_INT1_ISR(void)__irq /*ISR program  for EINT1*/
{
  EXTINT=0X02;// to clear EINT0 flag
	IOSET0=led_2;
	IOCLR0=led_2;
	VICVectAddr=0;// dumpy write to indicate end of ISR

}

void EXT_INT2_ISR(void)__irq /*ISR program  for EINT2*/
{
  EXTINT=0X04;// to clear EINT0 flag
	IOSET0=led_3;
	IOCLR0=led_3;
	VICVectAddr=0;// dumpy write to indicate end of ISR

}

void EXT_INT3_ISR(void)__irq /*ISR program  for EINT3*/
{
  EXTINT=0X08;// to clear EINT0 flag
	IOSET0=led_4;
	IOCLR0=led_4;
	VICVectAddr=0;// dumpy write to indicate end of ISR

}

unsigned int count=0;

int main()
{
  
	PINSEL1|=0X01;//p0.16 is configured as EINT0 Pin 
	PINSEL0|=0x20000000; 
	PINSEL0|=0x80000000; 
	PINSEL1|=0x00000300; 
	
	
	/*
	 PINSEL1|=(1<<0);
	PINSEL0|=(1<<29);
	PINSEL0|=(1<<31);
	PINSEL1|=(3<<8);
	*/
	
	IODIR0=led_1|led_2|led_3|led_4; //p0.4 to p0.7 as output pin
	config_intrpt();

	
	/*
	 EXTMODE  = (1<<0) | (0<<1) | (1<<2) | (0<<3);
	 EXTPOLAR = (1<<0) | (0<<1) | (0<<2) | (1<<3);
	*/
	
	
	//select the trigger mode for external interrupt
	
	EXTMODE=0XF;  //selected as edge
	EXTPOLAR=0X0; // In level it is selected as low
  /*
		EXTMODE=0X0;  //selected as level 
	  EXTPOLAR=0X0; // In level it is selected as low
    */
  
	//now enable the interrupt in VIC block
	
	VICIntEnable=1<<Eint0|1<<Eint1|1<<Eint2|1<<Eint3;// EINT0 to ENT03 interrupt is enabled
	
// main line code
  while(1)
	{
		
   count++;
		
  }	

}  



	 void config_intrpt(void)
	{
       VICIntSelect=0; //all as IRQs 
		
		// allocate slot-0 for external interrupt 0
				VICVectCntl0=IRQ_Slot_En|Eint0; 
				VICVectAddr0=(int)EXT_INT0_ISR;// function name itself indicates the addr 
		
		
		// allocate slot-1 for external interrupt 1
				VICVectCntl1=IRQ_Slot_En|Eint1; 
				VICVectAddr1=(int)EXT_INT1_ISR;// function name itself indicates the addr 
		
		
		// allocate slot-2 for external interrupt 2
				VICVectCntl2=IRQ_Slot_En|Eint2; 
				VICVectAddr2=(int)EXT_INT2_ISR;// function name itself indicates the addr 
		
		
		// allocate slot-3 for external interrupt 3
				VICVectCntl3=IRQ_Slot_En|Eint3; 
				VICVectAddr3=(int)EXT_INT3_ISR;// function name itself indicates the addr 
		
   }










